from sage.all import FractionField
from sage.matrix.constructor import Matrix
from sage.modules.free_module_element import free_module_element as vector
from curve import WeierstrassCurve
from curve import PointWeierstrass

class  Lollipop956451(WeierstrassCurve):

    def __init__(self, p, a, b, r, cofactor,L):
        super().__init__(p, a,b, r, cofactor)
        self.a = a
        self.b = b
        self.D = -160807944 
        self.L = L
        self.cofactor = cofactor
        self.r = r
        M = Matrix([[-L,1], [r,0]])
        self.N = M.LLL()
        self.N_inv = self.N**-1
        self.Fpxz = self.Fp['x', 'z']
        self.FpXZ = FractionField(self.Fpxz)
        x, z = self.FpXZ.gens()
        
        a0_map = 36*x**7 + 52093178300019920831088149019314051232888168213855215466901398150856759165825142081300844754729266384812814186895830464818765409742963023209668068685551346824229758381291518549836095942317531113567498632709984830589066459540185798361769089894601095269793749238355573968396396248472966113*x**6*z + 101625270205915329150208244036819233114776677616667682143562350825890865178202618867968193383272169824102770255134215560272828592132856206249566232250400100147908327548050934015830847570278549715833061146739117054229084428040626154683019547224255401224433239151559275298375055242429392406*x**5*z**2 + 258434612088532982459344832459371716164045912907869304007571927894976984909716855974908565025897366164837992656504502017564296085382746721794012450276240627660364415626173564869675144871496806576080838085173300155092842544035299481590678456737686750811831784236306123852146610036252044571*x**4*z**3 + 169182265156315503932301417218794557353750714049107274750690822309494126528698399826952011883907685014506964714875663726886573181578889404419749469102754094812412448720439521490181430173244984277129958796043727359600252348021921086168670570254415080322602459633957659060856967392923559758*x**3*z**4 + 32645377557643449306671069693716494883272121329732367387366063547712140615654411978740340013400118010265778581978703766236105507766918402208177262324724438409523308667540034919444947946129938978990299003835351560181949670206743556207688093271021949880364576744650139720101999831902515510*x**2*z**5 + 252039864364971734406985414701800034827439835304182162328305103805921810303977505148164333856551626170723584501150114861683813479431717379988209083981417018171478469207255850300091172828650018553220539692191184094208385456992651976113387766319305806867898873394430586344415060994084601245*x*z**6 + 247308289805541814661115560309824463340238179875245956570532676049791316336961356169769559580359974376402551636054505296199468195763532031676306153443238851840893084361583172051694064585116432650517752211089147110223010401507471329295641141304632698693325812752135693833445626018245107073*z**7
        b0_map = 216*x**6 + 312559069800119524986528894115884307397329009283131292801408388905140554994950852487805068528375598308876885121374982788912592458457778139258008412113308080945378550287749111299016575653905186681404991796259908983534398757241114790170614539367606571618762495430133443810378377490837796678*x**5*z + 162125072814838451233029298951232469136864583214201686433151727172795925126055444333240669353645004663840271569490148096602470796759183106986042121724216713378942763898232097425152900006150475747544147258818009812119643054999184096996263783742729129692366008632420133444715140056900511954*x**4*z**2 + 279879028411507332634510735373739535464986379401760009218378678364781594708221238156200665469187007733747360706408015092833315993618887696104537307043391883070509553600558296005543637182151980139615014154928763814526567140060848431341158255450711540727440206262337594944078369992458871919*x**3*z**3 + 64540403583062258976072200252673540547841874808402209597757777804591842477837962770725903010027620629402183629109335413781216274427483652762762988613667671788104133803690571491851652001703935387850099335693672842751236608420222904049552546359559441219091347407474492466325601475438491930*x**2*z**4 + 315867002703168198541123467858808287884118081039117008022615737496189805220007592429815446224788134444717991016555616222726499006037302683153164771043727307869617917806911797663147322908119772997731099189944411457194313281792663631761292299610244065678367107630776450956517502032771362635*x*z**5 + 84750481658368488859932655998829222173793819073655313937935537243733989808543008188572076720586408324189517939578482567617779804017655060141227159121526999798881200178117305355737511723826500873401637902267653446298845370199015548236993320225640664985604263368070622103232971249064790076*z**6
        c0_map = x**6 + 11085104051803073590443870335240333701902504078788795317563944793589177799498182091056471337924385211085647418551935087587153456656940013095752642349724274403939241043717824589219553463582610407574003031072627603385125702860199044312701239504686841344319595387284411351523079044933046011*x**5*z + 115837262241353735792751913787449394622409735216007150107364382128551755152043536646937526282294396750080710375459675192591442649528548421282865929290900038930933257533631160572994837193178325832023752785040988830320854873587671463389472006134291756853912094146974988682195965930384367793*x**4*z**2 + 57793859054048863341336011619138897223580985365073783856937373584444582058701718819519450053740362523779398969751702848410742437637224478839123776373763402741757983355580071794603843751117306540020672265707907417658837814894153800124119804789808529187900649813138242850800857037748854663*x**3*z**3 + 322834518595137995953557433582027113937436436158189065789020628626594010055857372260487170958793738298829182301977100305842642509451594574025932569891237298350140731981271685974045499809827291031378133617000195235985608085332846788684174269059403202305022277116009024800039188768482916523*x**2*z**4 + 95588887505548544476440179723946625224311654176354146482422715551709889817658949434515859567482075925283206585584583334539224952219199356335327691322408710546308563062402866694020184360505847953180902438674401664714993291009556923789052031979438510994937259918467177181244534259216655119*x*z**5 + 307776330919120610757256276241369893466823808171064426370245272277935707585628373869777692080335589614229926092262526934277698875423224413765732766062387817621052919319343478396850793195473188418285308107093104410859606229340401953778985301702453975729834101966409165888307169415416524268*z**6

        a1_map = 36*x**7 + 273273281080736870653053436810408693914091736013522939915116148363116378228026843408875157492598038879811907050391905004747309875885634021327443962066886997849675859452134634891377606663629268743557880944897632051712918647901125609630990483069737008218226618552716118144210249821187934308*x**6*z + 104776769605450814481285983876507433627895013789236527531355271010428816902225577340539818839318902476605391214457602716073992266099560803651302682325313288009797927885185742808481045724728125390059882768244405322661515528838445125592113843080224711393897427629517451799121024123953717643*x**5*z**2 + 125946996076625134548737294177810713355419844980128575354801907503427709646708062259531588593062892113010937811389768553882633061916938361360381694992703931121757191283601723640290403419713247374839964973956612695011662001060736422874422029077956697503791860513771863409810048564921117533*x**4*z**3 + 335201731215499922379775993058967817804098557841407518385885080977611027778090517633731093050246692287512031045097307715385983592992221161111009411048358931726822868507126096644614910183455237960635826185337277278761040654359182414562534777040151475275440608373489810763296638203560437786*x**3*z**4 + 214395254717938006432706061630853711963076395930907029968065442858648295475516814431842475527124285557172603493988010682381025467612459391266622133656321141425079565479418035092217859163329229422851232433207588376631061686659435703786539043052098912590310797957179193281968126415952860380*x**2*z**5 + 69689421607828878268985248835962878658797569583646317862482604564181083755465771009949859307812000274535571724432768265543133574175160709116290029541316581462784301620162616635049626523770122424123380127110137427478001534720096221022186395152803160507462818070150149010041194801525559045*x*z**6 + 135334249385933808738419572863332632114214117675485219726999563479489490757357613884393606516110526565698429788557627134326776835307483115091656204398950303260963212396422059371563119051949525570176299928588498827175008260062538053458502074137397709992806709156401417430951718177521984239*z**7
        b1_map = 216*x**6 + 251757416224858310218755888665100315342142501590971975629094432505283702903723407666322451313393828421789470778456099275208823135686294335014955548783231860227723479942607142699994324995149838224960843725767356745175676513698834470204040769321921276806512972500763770119523701450660844716*x**5*z + 112927789715328148191212621489124984635153952305603865522441189618362086654189833539799705664845011553885644003124239325111680122858000314469904664797214315134641276553168273199137664639109117800512603497829903535605760216278998649863291007007189832652338926184103558835618195458442080946*x**4*z**2 + 137713240372089457353006776923646873720060290178277978968812762513049812690462732388667628497431410463639386792138610847707378730004053158445507356761544357478155359727806599451448136654240331733881247114124723504452044828101298308142731010462151906457940686099046061742312627629715150642*x**3*z**3 + 266190474099022952160150716618134138563061044476155818462494272822332176084964307998555895273918401640799456074633884998633101169472549844101512264355730744882800750720178794989955295686866408317601347824669953792544101841165974657155669519799598184845842994825454891033359595214350959228*x**2*z**4 + 25874584147990417296800484724586420421112314441613007993172653350309442341275945391856097370946438624260691903808119842626162263341110138412761085903122257097765026893863923558638548017934601084344717337693424377923722893900453448252796173856611788832358127588109996235523946804084093070*x*z**5 + 40298366705078848866560795372128456092173691846303411235633206436731620658930295015954188926271603255424385752040050302734409058957551103678216370109409913654942526945490680453454746640922885117928299499529586696642665198521110538225764692513949538719585575940208189666291594608265733415*z**6
        c1_map = x**6 + 123247780329428489215326323150068451065036541096778331430553431149537779933926105604712795511643923706973828378391052701793678284299115650004904684247809927179463080271187128745449765322875183095908811299326470520750511799139580088121574913065534425714632412083314303732817323395849672714*x**5*z + 69183139080552903293448583103917959253224745924385421231028297284311668712547995384510502280525094741694998595582573614445211556091743219417411095960020802563588875129718742429777133226172729465520803659544637690598873602400870306348694256427118181304572928257146759220580643720388811043*x**4*z**2 + 30308768211786096092394121217775345792589246116800200168564613425234387259683962058311406310065710741722320469981743527910465072184758561644946226819551143376389816471335439151684294135604344064487565820411801510049804072873469727932140486336957369263095393120847184795575214949973031345*x**3*z**3 + 286602558769953442942987695024234268189121740420356281522173354270880956339546368127417046321905419897598869188243563409090770844043855547400336918468726965943620587773301576843436750130493802298038343735883027743957774226773072520377154411225315029531672640614647327679465706160796403568*x**2*z**4 + 167826039331114358100718022215503321296270908102236805575844059632038881425494981092599378874516506987654774621583417336837286593888091241890148363528673865489124947268879883961643493407373161858930835131734488926992241803931324346496972420835219973218739232470087471562769516193176771073*x*z**5 + 220583958489697287871987179510025461091190005563308845435931282270134732827082180112496702350695842250282715606539046926652405673682427360913195271645661344427611645507504385675815488767090116591828476005959060449103540831480946454687723618435101301105074096104215336863419997875177342424*z**6

        a2_map = 36*x**7 + 160709482922905657596027866236216919620843588765293794244379512354106041235171911743993215419520728766804386107875485434977620911700989132497383732365241357469396485197954673983077409129896089174524087826855249070420271681732761871110567863582234376285937659109761410068402690713864727378*x**6*z + 281614629406100270982544946338658174671472686016059758949012399792623688673856686749029115450742557806587375817439143680711376102068814861533018305607206195083759716790204233738151859598561601620859529603884498011142104756408931087551557843340171793875778480565214775028217345893502971817*x**5*z**2 + 290757630225730524656732300080764843180520895191639959960452823016567383312641344464923372773122629794191708231564997482228308333985817367297749840191934701173538233474298441259165386386070143054851822482598386036263476021002375556734693418554072308392315356015377259842730306241875157968*x**4*z**3 + 23796325461642658986744309828699825470914289573639674401159876040463888841285313300596480845846705736369731601733031995501135599346902402572398219309176606209827650163008546960225455639260112775556357265246790505111453561238799869777290841784127732377460978991217265403110770581503487327*x**3*z**4 + 98643360086267892249701804652792926536764416834910477979835987315034455777809225507872736917844124397199943221539989510651771300627946463241866159542625117509943735114359521598075992939140338868063809709541529490623494266208877153084175291209189059094189747217493767080132301743113085339*x**2*z**5 + 113037619392772139952201998078298178759277673075561015416378871229168036172746948847043826101089137463234392084148632781127105785170527913695834357076019305364013372621840329149688149853656739091508376697241321784442703231776454383305970520077181783259081023057154204653697046620119160054*x*z**6 + 32458062314534341639627331840763941526197476752738952335164782980229448008028780668206177575301574409632900407245754666227061096781335768144266104426551910807808712411831364716174695785774990263506451739253761198976899758789042505998856860327423203489700605262844535669742392129644192313*z**7
        b2_map = 216*x**6 + 270315762407652488726384831318625593653857575346679933535475845287928964178812644070495045696027170172285330885305247233228207410392179898509448282382403081381213072802627710574328797286063647928951305989322276639970712403542611632872456116945155871464202585250801991037547245544954983702*x**5*z + 33555617998312942129758229926726435976492367207552820646726797266961533714425011130252312143819303241444882402628876771474013741408540897423260158311815148077518419660257431237851801190805363466514044114980184543208044032260486453014559900433696256126887334408642870215091399438167939273*x**4*z**2 + 152636937447283692213262378806592974945716837299384123743496206934130592031251838547697483563396624999169920189349523092336584693816115351968867610094483207765434344025283772299941134592935252237984222534799609987037090644238047644719722089673913287632604692230415616261672076340991358544*x**3*z**3 + 52398802628757849870623713369141808919522584487582478547031394658374324217428604625804715421273785046255918850997792600053604388168467864982271146323528093089881710542266486779919284126658473340969888279169791790401231131282297992500682791427397792348082190846629654059038786702748730572*x**2*z**4 + 141363272591780114871400264916356180054176560023601110665681756334008121516124191360513012042696664018644282792351740490979851209336970664029469069606658552531258929749256676327680923613654115262828380640189281653052712084991135314765210615705797606446541618963877773792427854151244182494*x*z**5 + 166534643694648153429940204510962059204553082065756350764998150466790482713330538235483576805984065668275910810217444232299748681080856809005236129776930055371195113582558925472827956340589988488568301640614558533657498091330836186836772629054779434575511256831416930681989873628498858321*z**6
        c2_map = x**6 + 332158577225810845112286891386491878578647523942547276029666677849392496005080332234246816982727032501444476223916272134383761886903745065904719545364416873218533770492907231680371766292117088060661356787433665315938496454395835415709909332247291415071114859417827538594643721368439783250*x**5*z + 289115265925859081386253235857577898163527849292375263986245415079949644535825015778852617628687565002655078958455959127798383624932321583775249941754769794162782437578140722219214912416308362121923536907950054002344556856452064585361615094717104561525484273814070555171455150464897247270*x**4*z**2 + 1262744787273165565319141833489531990331431370988183537701814092796261126081403169519437530532656377175437617770913016770894748804795518898573537435554796349590640986204261913007401115755696035257153357412562519819425462611541197902578778000967292641043894703220642748083792811086172542*x**3*z**3 + 119008143653832960269441297935985866794712474085306196218085706942673854648752987699394426398221552141881756438213888374525652865485784396160399352161995841751863470474533647223078531510897545604181139727420290024066692207115759584123876386409615436132049782978564056621961920972247749260*x**2*z**4 + 131426498723692698274277966377779329983833503414395186919025441374736004217768996242825566613041411228791469549174630391455222221150931964408383710316814124903745901139924553336546967931971907027501653787100889334091585911741382594027670385509324780480056597517328173000407234347704726306*x*z**5 + 101454985793787133726597844935240423993175497127231411771280069358745381684171895778216520459984704337578526541875112531399125187419604538976512826783530732931195720848286165291975612354580205048954319851481267517202534962030086361141437064198385423499475441007714452378753187698280589577*z**6
        
        a3_map = 36*x**7 + 72051954641070995332123494877613400437064939891721327430104194295131435030127293147064534382858646173012119351352364243444831021710793824341966892589109709921780456962694010102973114569124207605779625882297512866436894351980481797677507831875319179738922669313624931501482923367595286720*x**6*z + 197194319690574746285617381297133074746714601541847573495761748149381466177554910237326256478824401861425958904957814876515188176828724578710091763629321113788421538520646169726202037265890049884374298873322297375662132592885804592225962675210852386883299855430556035739953601350418429162*x**5*z**2 + 27315173387406020102089002449098244194914135313382944379738136291988809584257802345653571801860870387937276587789455765721055192080253900398795003720217224408067137033562629457026824686310657196410776250849091841399335378428001113608579165120038658985656971238962051375615785685233488406*x**4*z**3 + 330216963503818405854620227084529226083244412924072438962129073303667516560411056749885077924876092232546752299725022084096114998269467528150805649031452717694533930759605275713147889300654307836488870620674705126572758818232392842666144019213319203983432991429033130214454029555458082828*x**3*z**4 + 207786834891298999638339124537847893646175824646259609153069001784910094510928312072059427883931190394002957706020930552734544894404581668960655581299085950686416981697710361048028421711329894242589699003353866760457820937988046637903205210761997841181495815711637965883205973906238984700*x**2*z**5 + 24073143896910356653662174162412543013146181671089999278503860552854110211801426330913082029434474938602512578656894020232589493411896675676548328002417039734754501541334315664758571887787329837908103097028475394949390492476643327518728508639967208876764558444108790454672820302779069061*x*z**6 + 70705144135424704242676138800749014545770057333418704174884977260057716609974873353927928410274108767898982885117400864286052888152709103915484752985534442438940440621558845504091077649203393646712503481060104262073654354037869322148486260755993563852670676653456677190314074532765767706*z**7
        b3_map = 216*x**6 + 85341160281535243567849786216342440586787660727786548615224551352434968564654345685655082886603275823802223227140352772350227100357885497814374299630135727813099822583613893955770858668088802075581144807880468307345907268455910989169571458977789885307824331177866354322463090836455030037*x**5*z + 191135937920435070661956047506535903685662971609765232098670569882366297951990627765493912767886275444421341207871685130481832401138476674550506146751865176598399328552569174042241453789296937456342456280177591470556027638368147864862961332992914770944852414858077284681819267357025551387*x**4*z**2 + 210650597461186013923957173065883219376416099299704639155703620139203735057755232857417891274222697962729627662987114154199019380956288909774782586317860861972694568274228814888430955746225725953361723164465072257829625402172288462930775251903776377493084967274395227788961208140839561448*x**3*z**3 + 268401409243047154739092068057767168789291295822126977787327861114318197638781433303627485485966448381498792876226528165371375203015792500712719253371270503980301054639521225801032884182846476584249392345046710471079275918598469885400008106271220145993380598360984767233777837720453453863*x**2*z**4 + 123227115432877331759428010662927856302283783747567795779957744643169538569368946706316652325022703491159863118281486902413465064751505348029417426281953602956042472358615343563735559319109061508891465855951779111855801391215367548204367017662986548975027150076489603626547119941495527217*x*z**5 + 20678061402340664052229949328811736997770196329692764089525368836301752158426713139112505748726593079505246970048717612205965797942907047581278284479396512246782553776054796401229332611477367217298275297378750813576962483575681390321901012445939649084686354181894224041609780185562014118*z**6
        c3_map = x**6 + 117658299039437770456411602540824137357341352315617175528191987980982642622873340319662500425262273909562723164528843236201942760572036755644196987873427224737021541313147111390216307209138931397637193103143133876715066679808451093345089283865689486034651746826672881881630453216583210281*x**5*z + 114822247100888182406100774951729886747950522243967841417277607553078266851056778989664853253951593183788369456233753051078427006062886086694012540507538017981650357239446572588951115447152506693233835895974194471323651857481558257376596843449910719760922628984447183149388725318904527953*x**4*z**2 + 71917347354061818452056243794002304184623362035221540613870730757091980760524121182353329208426057785631100206189804744924738822273450773197160511884632279171479602775616744577379116551254885680677328665167347689248092194266700083796197327999595076445115298248964389114591403512472789641*x**3*z**3 + 329097996962139179980512172671425296273207867941533241439645889108619422143157766719870726975870984510797033114199007947565321435950001178068841212138618767561436153719102303052698384363960771154887705246838238963644711476871281137523718784262061528124373956388474100227981980484343358094*x**2*z**4 + 211436656227068744196273849557907208959254734671515852596204894270167673541933304200314322466985889085204358250494762252142634408722224664221555909906691891373383843597069580625095952623392177723046074982255122877940150673488213091823870521440129962714060016779017249176704629132728294646*x*z**5 + 329171517312602726918307103811030292493720718202231342504100071591035063032033344414726662609650391460930611211626724685840460040296977298858845997231495838158352274341786121705499719083807294408395458761659652830915044693679414080249251422646847627141140818744256067937920860862446745268*z**6
        
        a4_map = 36*x**7 + 42039168679405757841470408482019087837950687642716461905493010049282115977105756897427168426215416171763254105266296759478531500283258135845204354920677085865776821476846276200926096202110053472602333591542630432589983539592885523610082886096304378268762492250257703212154148619634723844*x**6*z + 142754645285062282555103636986725080981534569437979313969698486103067237171402925860180047871294151930794686989898826260580590077786652000714893342651926907240050883013674743653697756260933040551170159394456967953142718953581381412587621671830839962679923906272214520618115716112350071857*x**5*z**2 + 154946440971817692848172620456805479271622295373701290003456001277790995336063508311127928973643991249102965875744014236123871595011369351128897024860648818042952377524188423336678568272476467255369109931593047435540240958402392673387825181117284683610739756064867515016194654963208068497*x**4*z**3 + 1376600947036461690071017325347868683687824587130791008020490846301743855571820530041525283596773079168127595419394890459739736177739896487485867918281675550664108998970378938583430274987251753368530164520339278005042978973941071984946088274221070640740502471944037235205951588994509938*x**3*z**4 + 223894554974773562824112826972210869571398883223225500902265062197931075071882900613438504692158692190593498501522363666876028451313817394900889830195898721215590497866818921567639066658616281656590188336610319597427307198910183463133194332924701959112908233169509875019951566817760579078*x**2*z**5 + 333102611007258716635592223035770763069958381164275668138193307333757794192947977855600276475915050737839436832601578177041713543616871155571636502309670486394985983464931743867935486352263379604401797587761003108224397307155870941306635020101848912015633233946176317539802071727426469284*x*z**6 + 160631731757781058798706719468508977069887450335909482662124103780678976080321081764275142589119702450242026931980129171015699363187458010935292239143499452898892608479939881645669344084075456782528723705079211376605759854555078088389672233962472186159580135798380979220264478393882546199*z**7
        b4_map = 216*x**6 + 252235012076434547048822450892114527027704125856298771432958060295692695862634541384563010557292497030579524631597780556871189001699548815071226129524062515194660928861077657205556577212660320835614001549255782595539901237557313141660497316577826269612574953501546219272924891717808343064*x**5*z + 89926150340498305603832263865614765193647904646669435145938073950039444276669755224799172164497984557132608743524345806220404557039766914745128348123858816394543213800057705652086739031498599060360882776751324679098667857279441369355478666704760457296043106223376535657501555409522812142*x**4*z**2 + 166488818651354821730222285822849026965761065840529929282225991874879189349827140201719408846534168750962688058008825700661596789596326223653958559910556339873298310291529849170006930916008188892512735957988036896784164727175931153103536896696146046453405362080716100043873626898087326968*x**3*z**3 + 183417431331179410321972406429343313652600081811959062362850525876334781619428117264730730951366364295796391706906154372025702066787206681149328489425754206722823306611143291623766547499403227024434546118304487107715912270144919084791692810841134086962006133753314089277767766378322013618*x**2*z**4 + 4434628566039047214234529836274591449683941210222844242739147371280583044384474277493398903411998345244516197598338769466225345439910227730206514341633607725931006279648591173822952369666284437960659122584783074526708580582990909962995039677723407129323096282281295560656827735188415093*x*z**5 + 34712534244421646998464935882106317971598261113284222633831526505342247461019462960834565844326216537502752243787121638583393734321865598336752628637885411177002935664428754569548604578508183754396058417504020055549464553391876176361452837319679040143667405778135834787504549553466431652*z**6
        c4_map = x**6 + 155376895825490483684436926035317402233543954044538308815330634465081677273190454667920587305416473211113642783356878327016074332744258258545667701372028822037419542459934692855389204337461476400504113926833788130361036806511793396498269205624508540785559706875344151616530703847930604677*x**5*z + 326672600273765570103218731568792828503393645103660364280060132443479893704197431115429762308458096728488842256010059512616857854412356870386469951364496581189209138577945309025577953912607176019079658507983692417762130449822378629145030841982491616333710896213484931649735447678719366013*x**4*z**2 + 303728355016808638990127971253804842608857455585129648560284271453472326567934845694163375736254421660385649240286469973586279670063776505176766119536710350456650592425611897186301944125571763193913836998441753947470844967144104875690139952630473430643001061330590422900524683230598293664*x**3*z**3 + 85737526740790281608110239792812343667688998137070842681627910212042510218787021188780350962822800775032040552636175200658706153386539312768322039490056156020428687894638068182109082975651462815810418633968761756872091735659211482931649095663529825826724259926840022047497871621610765323*x**2*z**4 + 33686152215852827181429575902679162821253996893312689475304079449341615552732844401037770872057853384753375540540305434401469033277418402523643844492024795731070143731849948779514537200559862753501641895947414884077590662878250026866037344014059604403274885793964517905350381490668991848*x*z**5 + 150063481204209684903315030011067850983532976922666061137155022059463971828391777222480563029610081541949686988100472395970903043132304630026184168623680075802865427560935750400713521591651897044136029268791128823851217335556668206412124521194499979689396527791850271974530274883313100062*z**6

        a5_map = 36*x**7 + 266367257614242697256749150480774161670531929107161330627586244457101850207239168986949790341504281215192544050364290821978015897530759041226492093088906435694106195713840165282074162017775135018544274414813388922132509697840178279756022559562347864950042368785128553136000841226010105197*x**6*z + 53584140688753460663067265796825557019090965263058278319121290103473714322135281970925324648573013551376417505071461192114362827040687555382673832242697457945241397798134044615166048464219883959046283659305838172597321836436761585308862762453175311336312893758410208064243074248694467884*x**5*z**2 + 253106219432361265007610206743626645652470269698789912535831821090326289481935131039805865462496726251875391534580046551586073759720476399881382315485559766119065130363069562641185530798870928870200293885569112510401603555391243499820023869462327284247700257982973222055117670770385130169*x**4*z**3 + 300094958304434941578643208578880338695367664893865911194548492038744081717405348775295599095076316628369020607652453984753139939185777919193747268870911811731830875681185708434262372177200051876727856980892957071550988932193555549737617711328374920460341459678393432621911681110854305024*x**3*z**4 + 122636425737717324842396700019722140969185639776037893813357264638500017642886817366706113840342491945258731658756748167896211228583162970476817334786761778195447653534862348790350420384000721188649938554406058251299247185146707508457520768915894665108180339912838061722853789546767864736*x**2*z**5 + 343765554566743663533916190224427571669942189893039963504153029578533852264079424116757798520233100224668727374016857588286733017114810011197312893358772591277144368654717025955839956913874875207125030137220934591216137597588306758714309506290580286588814194208419799280854972205989590743*x*z**6 + 148287881848755360295979951005866959754610239543266902396962413640788523841188510736977414866920581632145747081728405152526210845821843015192324005693406611619517662403712233499007799581395939573090717786582631193540853416116434549365799240785096701472959484473491624566598826962356120491*z**7
        b5_map = 216*x**6 + 210321275425893269840930170687293121880783660152802319903915009069196534778997361134770248406831282434073292778290414178593059265557044454409244334915348487294305497512840325044173657120025035874879204545261897967693222813333150490954233228277586417197407473895238380070267249879593870050*x**5*z + 241753229210131443482007009799024221161380839043293251995796994728428352647780254905985325759642117834745307753757822837753378870760457140587287177201531185032285492045854990439657228716028256589129892191042234216170196919607730656378683733151902968598596365102058024155647299063885110*x**4*z**2 + 40681790719612977388219514410372357625384868642597146618748577600601564630174541788399488004616404568055419869051538066871455769517821721081788157259243049808212533134673894759670425460352823582087450584053322328564755382029447603206448516546803303415867012253820668542866005313723856205*x**3*z**3 + 311396941589667443667543916943217823723991378962694252544193539991598226828685750450559141551509530613308885815088294688408653588399313270082362203996010118079599972985869652209700477566703199405570094157212698205375805556516953273831474032747033994621646753639088413675023449424863094904*x**2*z**4 + 179351931595238690995749183591324121109897900814221817204524237546795341052777233855467488342763722313111134406862601714217834797803211323928923884925595238647646081511350733039334620814784336729638497749575004596133166831979327676087960432853091249038082269914120338939901690428233190428*x*z**5 + 152669293757829639310737363036312630890819433508703565284524895753121345968139887294607891169763462799281094466365784434763550966072718421857427286349338234970532125461399577336179635324748116610055783960047885049422900558217323242950693825572677339374004754865025277114922538311341407311*z**6
        c5_map = 9094825456362134377739039966200611882356394584447552130953334995986222523674938749957834477657522555506454054958501306854697800448811738677492355916541999401822102256255492843306738885359177614539*x**5*z + 121220675305776250368415655229609830258509268439348623513835221528631057770143220952755269548146962744367285144639484787554022650062839127372802520060906865825217404053618923893499097824103013578415181492439160659632219740114785061983404826619377274860748214501152890067997179393885958877*x**4*z**2 + 190697048011410636966043590703653267347599752861351014554390045571598218594799619158924360674957575886125123935968062163300628394831569663928227411585330422354581425578519476356009370513091820711411153456688026272926498221390923722614992972203161254754045251770233539523623561073225269702*x**3*z**3 + 340962286556456431865212610058633797656569950921229888332813921803260004399781680184206472780692337959030690284731036335360864656290450971159903065563709384343773158816057499492611925326779483424805193096695036622853490318088402596018012697863647953805368342654866067724565458964451379225*x**2*z**4 + 208104523007295582523097348710675835061617007818426586252771621592075743562695810135749531760976523048342187110025512522147768264560738292931646834723418907947438536282795839581534799347106897328520381814310699451334111683587817616686036362142679888832003468645496944445733208167651741606*x*z**5 + 39688665669093579944710934479731563550363363437767891721896462052022148875572046094819571479643742063689172827866672334086910107620130451597567499847073166519066889783032952391902811911594077744060710771038808494110392986549097409484989669467116006420274987921958929255619910644178096220*z**6

        a6_map = 36*x**7 + 272644270580598370050588427467250406257211315216972318551544268085626471700043483723613974557662790633134707098778579250808250008307598608119386988422215244035943518682512093045422813858317976629884436078109857100203414015432881474557962014922022506615496577171773663674343831676522216160*x**6*z + 108418431732858350540359523741539728019269252698352433342597025176151672800886958149772077472632005234656594422551861726041278051441922802006021878461765569872568304688065392974467443662724128022665937877290689025947937530021312248628096016976603275227596665299560205337146100242578566918*x**5*z**2 + 210797290119363463184015489581835003183244268765620963139594201308638984611136313485664102032841264615666490119070128920213198834207843402976937256190995304690435005662655853637874663384477565804962957910223319100537014171767953507378290186036724082032069492556205454749277314764472791199*x**4*z**3 + 184783776526699343713221567026038377286605822818363317798578598970281971548188982584197379594950277496909734918153316711697685403333913501501172728975079771420334065874396197441537970111928023149760035258482545570890141767266725743244283372798698911704066216914125473442636273028179282943*x**3*z**4 + 286248029725806688469721085334409352943197094800450096311360584752222278861445850073424376140101985481926087188583618983342359419490261451944029554893192157357298000302393722991766519323642825521504667568929570282375803521139900743271764067804737719069005351419407801473731477539228129925*x**2*z**5 + 83845732365552855249865794554616459268788064779121878103075739823653705336936654811096966197940184937738674320273092477613320630284838318851320723496169589181190693213800825383987658735011455476593420520069003135584182805848881246234248454555004911996661560582517986186375795805927848218*x*z**6 + 320252497519591314509871281939588470430115426770720922503007356377839224590597078604667813364243399935270822758536248342890418591095723386884168826926359420926554115870388036360966091952530861651247784445835439071897102839025981110198181177084264940556744580591511178640466268246831447751*z**7
        b6_map = 216*x**6 + 247983353224027306603965832606150589400859976811668247447663150840344263735823249554755353703782338941726271068776144751574463930218081855766613706915201337345329435324871891624265568163282085542920174525040707036118648718889369659765869960435634267190132724215109043300325192582666535828*x**5*z + 253402732743087306928510304662484730947538373893267234362768294440166662220512499020835938398729839573257676095953992593207403614601257344943269557921667015576974941281412135374082311571631164473361326432048908164504780729668855267317764775136534146036210756698997956115870107858568836848*x**4*z**2 + 118456516297234356467386364213258945884925338274092328837136099998865935356693708825527795301355839374988214900126718968998780755404223062189501762732082164991279458884120856302681600687361284594454023903009085655821930528911353542835287989488823648687565553730618148065848185337583461526*x**3*z**3 + 281447275427663164198973482256841869508451601039276294705537041573219051119907745144635082114441017252530482170998308091395002040820522873344051702205470237438814578744103450455981251396249852350001078121097891425766329717244062715947331745156657272298765460909690073239122812185888736902*x**2*z**4 + 234019626279778711919888261990791876157680549057467017624414259350720653748727606574917441817534317984156773992891469008960408502026262224991727805983525768154556764697647910331617898385522600056189268233859487138623356561519511596598820032426604517427902857669533528841580164235837363784*x*z**5 + 28948557836479706018301931611995921751833955119510401884684058613386186213892242621319288225313055890927069511416438761089354803881719593740031053364072339805199932352376173300195293466543182556136424359279118934205885616232201141446864233084532169701817589277153501043402464555314530627*z**6
        c6_map = x**6 + 238887163670499329229110467240315597086434966726610175047809972614614274180185261123477359344745256104878514895615293438068290742390907149050489898059187666812720377202881002581529186216057572834672307992772790846967067396046677683334704855263917420600904916946249202670799183792647855082*x**5*z + 223768032340393700128334800853539353289095601828483362594603981539265467095074148819947996445708184736388549254120469872512575380040627245070623306153565924048299237191096413175813906730613783228981531129179317352574581126610285075699624045797811821990968091960111416577765404479607052677*x**4*z**2 + 222305875327736909792553685290784584846353004071622084139156198799535943949711321620212699923034835893259105663940169282386188546219433202630860881506191418881555404205049259022204092162524678557215112034458994949838421738806878327679368625711580595273622650900482072440783585554439423111*x**3*z**3 + 164023822347584680306794020863417556005496007263492255102569031447380210398749679915040693738395683578177506937457238877617588051633887503161428559052247036890978807766921528897438748333752872213330739017509509166896685988000205136123996020344776824427318723017895224729180493656605945101*x**2*z**4 + 267085606234910100600180745617034220244748816125425242680407696997076083202560192188014763603947477872110471891072850385730507108234993322419968038728776382905937115163289121145460541131299292615110338174298042545898638379906093396778709610063990909193754953412606811420388138842483445270*x*z**5 + 21844166927337073537486414842911847048816111897409293603226475731321079838588359823544110851760086170075138390428591355203440220170820289350740579806517579280192769562247309644518362358530116145199685305965255464163280959903084460453328750121165035983500890069690376099805015540338649286*z**6

        a7_map = 36*x**10 + 111579084120985904679171136156316960745061250124810118105938486427304619056079597657945637606946592965023023902672983253880313696693632031313666231343011563291680511154757932064960078435031754262186456580425567098910306330205476053392949278019665783523153634671269834036053341661440580082*x**9*z + 211819956329214005063397137796850190002390221098210944206539558743713936038660945706564250931239375210466796605921388803421496366750383755810381717768427403960344265210109045894292907365887737586913677119438714901149730108515968870591599907729280257845121275315423135359520432986746029871*x**8*z**2 + 232222377860953791481625598353892563289772989678297742378626766092025268516790713038124229777354888714748119624852861173233282689697947873377485514338027948716382491911287380305827072383204804856505980675475265688011137243640241767833536907705229678684925188676825223272091482636985866490*x**7*z**3 + 20402580227291541808586711913861146238018188503848933041839691150239354240838236094850955610954763143763403122374084461824038146912188331134048336055281922546933225617353417427081730522808900560695036436679476437087186545813631925160988616273217193267903421066681545906304465679532951876*x**6*z**4 + 293385152265100762279193531652145932873933256335959922822411530669695532886850203670886836097357904066307015468639095479026149012226879071794521161358293611825905312246604174532309667657516105511768917261168849135167227245681041999952623304131642838091048647913840052225321704078513661605*x**5*z**5 + 153653421107117095952420301414274937389307284539737419935854170837847316519938510328630323413270866276982908357657314555883928011158366892787412866711355285525576113075842835304784326660501842614751536292164566413251421408319572330659650075968302854761045375924701353257908691376502381519*x**4*z**6 + 278662627981240670860866243342165578973128946573014498578584073581448697086474176409001448104752963317404555000136106049471424368931447249151004861825246429027058662003403985288004564021352267496550997551625142532569704735753037031041968715691500100710096293245363945859413006993836713781*x**3*z**7 + 133200713712904327203632959738781136565912140038360955538751343233228000115680656451378540459865629801116874659993968586111875659227153999014142628902919309407170568170213323370440366746280133877537910047986908620954548477311557147208313794024413790347514370737408108317216024496727943771*x**2*z**8 + 11381339252883592406232184462510541707956576947702728788147524659450254851018250926473890148751595695356946614091086369105103046449039294163695260261552556949866092316170405150117886653560923731877209603270819895852084741045452469828126320149423191271256478448542809125773921186425108328*x*z**9 + 3971367465693843095699161993831115431190706096467776440552928796488237237178526791105525573573922273485290882410392300337220009933956312107378145735365538292316035370100217099603111047497831797188278635689029056171370558595729219844751546553779169423225515092158162631127895387139202832*z**10
        b7_map = 216*x**9 + 322503937161024699650135633888563802434765522126319292670230304145474072720368172750941702231130956575867650535064066834963123150254914739644570332153546848032500147735997425727692641863534082014022128996648793702186379137805876523462220135843869508013210123323735769529885600599526790209*x**8*z + 44471424807994656227952382112880466679809947391368146090976804604576719690227324897242230823726516076645489543701878749773187668522484613569828394928384848332388520632648270737946936045715149291958455208109320154084224701401311453094494240687693624240387855490578089632785700002554072404*x**7*z**2 + 146608149971115649082596540390489280364934106002117902750144648403364671219793280870035677236828071086028648992872463759613046832484770989824268762513339266868114633788258904383177350429361284362457481269419314205105762532597514697730911083870304025573598519294648472008118981312441550681*x**6*z**3 + 181577726729454778154293463785406490212365648162065459182246834584799843868582033235482424928843744977536039820994283184421144064773768505965953806492875546990448757103655086947008998949879323969366157441855779358019597667916659316366597673751147847520678825631561594264479097679439054393*x**5*z**4 + 3240789882549610176097380850973813538264901667646860141948806270726030506278779328216608769911554184900113488929508245217298843998771195926105056877853419734067465638853519980302874022598485677950825057388681724013126110777835691656980408500458557082374099337860336440990592109806110367*x**4*z**5 + 297842273112010023725591253084314133608763472490779587037854605281519891359892445183105041413399428762439613731838680495234597525570715095619298839358472788950922675509914004741156058365400296997114333325213386801954203831580256678621182287836621603074692676092569457751427407462913945874*x**3*z**6 + 1169558090255278910689808576173723617501576502905889631971183199371562409495353983279598868992276292771297148442750253099010165804192595293252920372526560879207350887652333250724052901119160027127945578151785181761291514343646925252189398062399824061282204650204987270163652822948791823*x**2*z**7 + 140750094090538547386493204409959677742571445354343532389962512130442392917775457313183455471817112356153136611995750604921695277687586128226451024026750031891943242096147266366371929036934465996793216854930191039840829326492599085171984206528662563934873634482700017499672270392651544457*x*z**8 + 111969758082168406506134207700162297236187280544976295138263036822089810201063239204459876516252235513959400842901594988348778548855951978343241536347769869358265631458134742826180931855068291781385375483692135016259900197445467387533846451590062142373536853119731741970866444419215119824*z**9
        c7_map = x**9 + 22375561645854648931359819507083135689340700204719248612131658757333663952452734001428052345223438760932333601795018017514384215458538525771903342865334906297967954153884951816363770442454017816121657709784299580040589556029428767977330565071331004715960472335528786205803395566657610018*x**8*z + 97819254943149038520244200946101530386331446183890094664924737635260625107923851287849579395499763219035565808180885344425730859717676680649186368746001407441595459668088477343119694843394680358302871655697883006322885992770557270162755107628264231389224755329725320821271234545089814132*x**7*z**2 + 153032672359316633447789230407454217845311681584624193542959191996948399227078924152312339692456128047961125823502611534698376598465729385941831603231780396104329489864302760593832064880908510281149316319870193778043045278599693508037740979783093196079928132860995002265857087601679429167*x**6*z**3 + 340888272772806958568776723195322639968803508673765220905106377398388567933070703748193224126198490628086674909891883905845817786452706937492692795056354288685790536826811982914158118529039033851255279877674077486057425015456692820446756234772957837626360664622666308392384000290484644935*x**5*z**4 + 122527683767251965884848762261899549252609773897154402764938924168518792842417000914890843436585688793791648947028353043449270063384986019704138032288562430717018128951680314215173315263515712322938722217475098658680659323460213710394209015747289699720131097075438307669456340710298483511*x**4*z**5 + 336312159341591230194065073800776933133486249136295589595651901398581182323985616965219502478868732032919348528879791415945511166881045300150317633659337202041710300827341673780023573682160933956026459452425824235705737459933950119476583729627552807486191066901818495945476800701900184947*x**3*z**6 + 94984199601582152022332720532872858330930302991486620863467163882981015142565088905112406533756949397669851151093222286681393363689436684012176684122422036348973391200336941663479408245010057148196071219100461189377538245120384523329542444909777543129378500829098742843928679764372222956*x**2*z**7 + 126367252561821344710764762601297213099550305511321479286528772941199259848685044757654490020053423998133329072601313406916724082772463194300048440849429879154521756499817282559741507139206995082349239728429522267095499823730630970982005049055044477157088900712551528951039259575439022583*x*z**8 + 166267179435539348843426987389993464768992631739625388228419162188407232586976691410599168215051577575771510035218028785306494420549169108691529545893083115890522113349957299451243376691374227910935273783100182511720858383588309794261738971264147144624067597504116120838140763646302709868*z**9

        self.a_maps = [a0_map, a1_map, a2_map, a3_map, a4_map, a5_map, a6_map, a7_map]
        self.b_maps = [b0_map, b1_map, b2_map, b3_map, b4_map, b5_map, b6_map, b7_map]
        self.c_maps = [c0_map, c1_map, c2_map, c3_map, c4_map, c5_map, c6_map, c7_map]

        self.iso_x = 1591776315227191114928250266108102815068276791771315371416973227795476042238011
        self.iso_y = 362723301092365577775585079158435711361056655579945183829463270975417886340321
        
    def random_point(self):
        P = super().random_point()
        return Lollipop956451Point(P.X, P.Y,P.Z, self)
       
class Lollipop956451Point(PointWeierstrass):
      
        def __init__(self, x, y, z, curve):
            super().__init__(x, y, z, curve)

        def fast_scalar_mul(self, n):
            psiP = self.psi()
            beta = vector([n,0]) * self.curve.N_inv
            b = vector([int(beta[0]), int(beta[1])]) * self.curve.N
            k1 = n-b[0]
            k2 = -b[1]
            return self.multi_scalar_mul(k1, psiP, k2)

        def psi(self):
            x,y,z = self.X, self.Y, self.Z

            for i in range(7):
                new_x = self.curve.a_maps[i](x,z) 
                y = y* self.curve.b_maps[i](x,z) 
                z = z* self.curve.c_maps[i](x,z) 
                x = new_x

            return Lollipop956451Point(self.curve.iso_x*x,  self.curve.iso_y*y, z, self.curve)
